<!doctype html>
<html>
<head>
    <title>Tennis Court Reservations</title>
    <style>
        .date-divider {
            height: 1px;
            background-color: #000;
            colspan: 3;
        }
        .red-text {
            color: red;
        }
        tr {
            text-align: left;
        }
    </style>
</head>
<body>
    <h1>Tennis Court Reservations</h1>
    <p>í…Œë¦°ì´ë“¤ì—ê²Œ ì½”íŠ¸ê¸°íšŒëŠ” ì†Œì¤‘í•œ ê²ƒ.. ì¼ê³¼ íœ´ì‹ì‹œê°„ì„ ì¦ê¸°ë©´ì„œ ëª©í…Œ ì˜ˆì•½ì— ë„ì›€ì´ ë˜ë©´ ì¢‹ê² ìŠµë‹ˆë‹¹ ğŸ¾</p>
    <p>3ë¶„ ì •ë„ë©´ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ê²ƒ ê°™ìœ¼ë‹ˆ, last run time ì°¸ê³ í•´ì„œ í•„ìš”í•˜ë©´ ìˆ˜ë™ì¡°íšŒ ìˆ˜í–‰í•˜ì„¸ìš” â˜ºï¸</p>
    <table>
        <tr>
            <tr class="date-divider"><td colspan="3"></td></tr>
            <th>ìˆ˜ë™ì¡°íšŒ API</th>
            <td>/reserve (ex. https://01d4-203-236-8-208.ngrok-free.app/reserve)</td>
        </tr>
        <tr>
            <th>ì¡°íšŒì£¼ê¸°</th>
            <td>{{ execution_frequency }}</td>
        </tr>
        <tr>
            <th>Query ì‹œì‘</th>
            <td>{{ query_start_time }}</td>
        </tr>
        <tr>
            <th>Query ì¢…ë£Œ</th>
            <td>{{ query_end_time }}</td>
        </tr>
        <tr>
            <th>Last run time</th>
            <td>{{ last_run_time }}</td>
            <tr class="date-divider"><td colspan="3"></td></tr>
        </tr>
    </table>
    <table>
        <tr>
            <th>Date</th>
            <th>Court</th>
            <th>Time</th>
        </tr>
        {% for date, info in reservations.items() %}
            {% set row_span = [0] %}
            {% for court, times in info['courts'].items() %}
                {% for time in times %}
                    {% set _ = row_span.append(row_span.pop() + 1) %}
                {% endfor %}
            {% endfor %}
            {% set first_row = [True] %}
            {% for court, times in info['courts'].items() %}
                {% for time in times %}
                    {% set time_color = '' %}
                    {% set time_hour = time[:2]|int %}
                    {% if (time_hour >= 6 and time_hour < 9) or (time_hour >= 18 and time_hour < 22) %}
                        {% set time_color = 'red-text' %}
                    {% endif %}
                    {% if first_row[0] %}
                        <tr>
                            <td rowspan="{{ row_span[0] }}">{{ date }} ({{ info['weekday'] }})</td> <!-- ë‚ ì§œì™€ ìš”ì¼ í‘œì‹œ -->
                            <td>{{ court }}</td> <!-- ì½”íŠ¸ í‘œì‹œ -->
                            <td class="{{ time_color }}">{{ time }}</td> <!-- ì‹œê°„ í‘œì‹œ -->
                        </tr>
                        {% set _ = first_row.pop() %}
                        {% set _ = first_row.append(False) %}
                    {% else %}
                        <tr>
                            <td>{{ court }}</td> <!-- ì½”íŠ¸ í‘œì‹œ -->
                            <td class="{{ time_color }}">{{ time }}</td> <!-- ì‹œê°„ í‘œì‹œ -->
                        </tr>
                    {% endif %}
                {% endfor %}
            {% endfor %}
            <tr class="date-divider"><td colspan="3"></td></tr> <!-- ë‚ ì§œ ê°„ êµ¬ë¶„ì -->
        {% endfor %}
    </table>
</body>
</html>
